<script src="../tram-deco.js"></script>

<template id="elementDefinitions">
	<!-- definition for a custom-title tag! -->
	<custom-title>
		<!-- declarative shadow dom for the insides -->
		<template shadowrootmode="open">
			<!-- styles, for just this element -->
			<style>
				h1 {
					color: blue;
				}
			</style>

			<!-- dom, to show on the page -->
			<h1>
				<slot>Hello World</slot>
			</h1>
			<hr />
		</template>

		<!-- scripts, that run when the component mounts -->
		<script td-method="connectedCallback">
			this.shadowRoot.querySelector('slot').addEventListener('slotchange', () => {
				document.title = this.textContent || 'Hello World';
			});
		</script>
	</custom-title>

	<callout-alert>
		<script td-property="observedAttributes">
			['collapsed'];
		</script>
		<template shadowrootmode="open">
			<style>
				div {
					display: flex;
					flex-direction: column;
					border-left: solid 3px rgb(47, 129, 247);
					background: rgba(47, 129, 247, 0.1);
					padding: 0.5em;
					gap: 0.3em;
				}

				[name='title'] {
					font-weight: bold;
					color: rgb(47, 129, 247);
				}

				:host([collapsed]) #content {
					display: none;
				}
			</style>

			<div>
				<span>
					<slot name="title"></slot>
					<button id="collapse">collapse</button>
				</span>
				<span id="content"><slot></slot></span>
			</div>
		</template>

		<script td-method="constructor">
			this.collapse = this.shadowRoot.getElementById('collapse');
		</script>

		<script td-method="connectedCallback">
			this.collapse.addEventListener('click', () => {
				this.toggleAttribute('collapsed');
			});
		</script>

		<script td-method="attributeChangedCallback">
			this.collapse.textContent = this.hasAttribute('collapsed') ? 'expand' : 'collapse';
		</script>
	</callout-alert>

	<!-- counter example -->
	<my-counter>
		<script td-property="observedAttributes">
			['count'];
		</script>

		<template shadowrootmode="open" shadowrootdelegatesfocus>
			<style>
				button {
					cursor: pointer;
					color: blue;
				}
			</style>
			<button><slot>Counter</slot>: <span>0</span></button>
		</template>

		<script td-method="connectedCallback">
			const button = this.shadowRoot.querySelector('button');
			button.addEventListener('click', (event) => {
				const newCount = parseInt(this.getAttribute('count')) + 1;
				this.setAttribute('count', newCount);
			});
		</script>

		<script td-method="attributeChangedCallback">
			const span = this.shadowRoot.querySelector('span');
			span.textContent = this.getAttribute('count');
		</script>
	</my-counter>
</template>

<script>
	TramDeco.processTemplate(elementDefinitions);
</script>

<!-- import definition from external file -->
<script src="./spoiler-tag.js"></script>

<custom-title>Tram-Deco is Cool!</custom-title>
<my-counter id="a" count="0"></my-counter>
<my-counter id="b" count="12">Special</my-counter>
<callout-alert collapsed>
	<span slot="title">Import Alert</span>
	<span>The following spoiler only works on browsers that support <code>setHTMLUnsafe</code></span>
</callout-alert>
This is some <spoiler-tag>mystery</spoiler-tag> content.
